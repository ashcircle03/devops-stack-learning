13주 동안 리눅스를 사용하며 느낀 점들
주마다 하나의 프로그램을 다루는 과제이긴 하지만 그냥 프로그램 12개 설치하는 것 보다 서로 연결된 하나의 프로젝트를 해보고 싶었다. 처음에는 뭐할 지 고민하면서 우분투 개발환경 꾸미기를 했었고 그냥 디코봇이나 하나 만들어봐야겠다 라고 생각했었다. 이후에 devops를 학교에서 배운 뒤 디코봇 배포에 이걸 적용해보면 어떨까라는 생각이 들었다.

중간고사 시험을 볼 땐 plan-create-verify-package-release-configure-monitor 단순히 외우기만 했지만 각각의 해당하는 부분의 기능을 혼자 구축하려니 어려움도 많았다. 각 단계를 다음과 같이 해봤다.
- plan: 내 머릿속에서 원하는 디코봇의 기능을 추가하는 부분이다.
- create: 디코 봇 코드를 vsc에서 작성하는 단계다.
- verify: mockup코드를 따로 작성해서 테스트 하는 단계다.
- package: docker hub에 새로운 버전의 코드를 업로드 하는 과정이다.
- release: kubernetes를 통해 배포하는 과정이다.
- configure: 인프라를 코드로 관리하기 위한 도구로 jenkins를 통한 파이프라인 구성을 이용했다.
- monitor: 서비스 작동 현황과 같은 것을 보기 위한 것으로 prometheus, grafana를 이용했다.

물론 회사에 사용하는 치밀한 devops에는 발끝에도 못 미치지만 찍먹 정도 해봤다고 생각한다. 모든 부분이 부족하긴 하지만 git push를 통해 자동 테스트와 배포도 가능하고, monitoring도 만들어둔 상태긴 하다. 불편했던 건 로컬에서 하다보니 컴퓨터 리소스 부족으로 컴퓨터가 작업 중에 죽어버린다는 것이다. 그러면 ngrok으로 터널링도 다시 해야하고, jenkins와 github에서 webhook 설정도 바뀐 url로 고쳐야 했다. 그래서 다음엔 클라우드 환경이나 데스크탑에서 해보고 싶다는 생각이 들었다. os도 회사에서 사용하는 redhat계열로 사용해보고 싶다.
크게 어려웠던 점들은 jenkins 파이프라인 구축이다. github, k8s, docker를 한데 묶는 과정이고, 목표했던 ci/cd를 담당하는 큰 축이다보니 신경쓸 게 한두가지가 아니었다. 먼저 통신사 공유기를 사용하니 사설ip가 사용되어서 포트포워딩이 안된다는게 불편했고 그래서 ngork을 통해 jenkins포트를 열어서 github와 연결했다. k8s의 kubeconfig를 jenkins에 올려서 권한을 얻어야 했는데 이 부분도 쉽게 되지 않았다. 전체적으로 권한 얻는게 가장 어려웠던 것 같다. 토큰을 사용한 oauth방식도 이번에 처음 알게되었다.
monitoring에서 뭔가 내 서비스의 리소스 사용량이나 에러 현황을 예쁘게 한눈에 볼 수 있게 되니 뭔가 devops 전문가가 된 것 같은 기분이었다. 처음 봤을 땐 좀 놀랄 정도로 신기했다. 거기에 alertmanager와 slack을 통한 알림까지 만들고 나니 그래도 완성도가 있어 보였다.
전체 프로젝트를 하면서 각 프로그램의 연결과 작동에 집중하다 보니 각 프로그램의 세세한 기능들은 잘 알지 못한다. 물론 자주 사용하면서 알게된 kubectl명령이라던가, git, docker명령어들은 익숙하긴 하다. 다음으로 해보고 싶은 건 k8s공부다. 회사 채용 공고만 봐도 devops 요구 기술 스택의 맨 위에 k8s+istio라고 적혀있는데 istio를 사용해본 적이 없어서 k8s와 istio를 공부해 보고 싶다. 그래도 얻어가는게 꽤 있던 한학기라고 생각한다. 매주 시간 쏟는게 아깝다는 생각이 안들 정도로 어느새 열중하고 있는 나를 볼 수 있었다.
